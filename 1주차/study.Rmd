```{r setup, include=FALSE}
g1e <- read.table("edu_sample_db/교육용(TXT)/nsc2_edu_g1e.txt", header=TRUE, fill=TRUE, sep="|", fileEncoding = "CP949", encoding = "UTF-8")

colSums(is.na(g1e))

data <- g1e[c("Q_SMK_YN", "G1E_HGHT","G1E_WGHT","G1E_BMI","G1E_WSTC","G1E_VA_LT",
              "G1E_VA_RT", "G1E_HA_LT","G1E_HA_RT","G1E_BP_SYS","G1E_BP_DIA",
              "G1E_URN_PROT","G1E_HGB","G1E_FBS","G1E_TOT_CHOL","G1E_SGOT","G1E_SGPT",
              "G1E_GGT","G1E_CHST_XRAY_RST")]
data <- na.omit(data)

library(ggplot2)
library(dplyr)
library(GGally)

data$Q_SMK_YN1 <- factor(data$Q_SMK_YN, levels=c("1","2","3"), labels=c("1: 피우지 않는다", "2: 과거에 피웠으나 지금은 끊었다","3: 현재도 피운다"))

data %>% ggplot(aes(x=Q_SMK_YN, fill=Q_SMK_YN1)) + geom_bar() + labs(x = "흡연 상태", y= "빈도", fill = "흡연 상태")

data %>% ggplot(aes(x=data$G1E_HGHT)) + geom_bar() + xlab("신장") + ylab("빈도") + ggtitle("신장별 빈도")

data %>% ggplot(aes(x=Q_SMK_YN1,y=G1E_HGHT)) + geom_boxplot(aes(fill = Q_SMK_YN1), outlier.colour = 'red') +
  xlab("흡연 상태") + ylab("신장") + ggtitle("흡연 상태별 신장") + labs(fill = "흡연 상태")

data %>% ggplot(aes(x=G1E_HGHT, fill = Q_SMK_YN1)) + geom_histogram(bins=30) + facet_grid(.~Q_SMK_YN1) +
  labs(fill="흡연 상태") + xlab("신장")

data %>% ggplot(aes(x=data$G1E_WGHT)) + geom_bar() + xlab("체중") + ylab("빈도") + ggtitle("체중별 빈도")

data %>% ggplot(aes(x=Q_SMK_YN1,y=G1E_WGHT)) + geom_boxplot(aes(fill = Q_SMK_YN1), outlier.colour = 'red') +
  xlab("흡연 상태") + ylab("체중") + ggtitle("흡연 상태별 체중") + labs(fill = "흡연 상태")

data %>% ggplot(aes(x=G1E_WGHT, fill = Q_SMK_YN1)) + geom_histogram(bins=30) + facet_grid(.~Q_SMK_YN1) + labs(fill="흡연 상태") + xlab("체중")

data %>% ggplot() + geom_point(aes(G1E_HGHT,G1E_WGHT, color=Q_SMK_YN1)) + theme(legend.position="top") + 
  xlab("신장") + ylab("체중")



data %>% ggplot(aes(x=data$G1E_BMI)) + geom_bar() + xlab("체질량지수") + ylab("빈도") + ggtitle("체질량지수")

data %>% ggplot(aes(x=Q_SMK_YN1,y=G1E_BMI)) + geom_boxplot(aes(fill = Q_SMK_YN1), outlier.colour = 'red') +
  xlab("흡연 상태") + ylab("체질량지수") + ggtitle("흡연 상태별 체질량지수") + labs(fill = "흡연 상태")

data %>% ggplot(aes(x=G1E_BMI, fill = Q_SMK_YN1)) + geom_histogram(bins=30) + facet_grid(.~Q_SMK_YN1) + labs(fill="흡연 상태") + xlab("체질량지수")

data %>% ggplot(aes(x=data$G1E_WSTC)) + geom_bar() + xlab("허리둘레") + ylab("빈도") + ggtitle("허리둘레")

data %>% ggplot(aes(x=Q_SMK_YN1,y=G1E_WSTC)) + geom_boxplot(aes(fill = Q_SMK_YN1), outlier.colour = 'red') +
  xlab("흡연 상태") + ylab("허리둘레") + ggtitle("흡연 상태별 허리둘레") + labs(fill = "흡연 상태")

data %>% ggplot(aes(x=G1E_WSTC, fill = Q_SMK_YN1)) + geom_histogram(bins=30) + facet_grid(.~Q_SMK_YN1) + labs(fill="흡연 상태") + xlab("허리둘레")

data %>% ggplot(aes(x=data$G1E_VA_LT)) + geom_bar() + xlab("시력(좌)") + ylab("빈도") + ggtitle("시력(좌)")

data %>% ggplot(aes(x=data$G1E_VA_RT)) + geom_bar() + xlab("시력(우)") + ylab("빈도") + ggtitle("시력(우)")

data %>% ggplot() + geom_point(aes(G1E_VA_LT,G1E_VA_RT)) + theme(legend.position="top") + xlab("시력(좌)") + ylab("시력(우)")

ggpairs(data, upper='blank', columns = 2:5, ggplot2::aes(colour=data$Q_SMK_YN1)) + ggtitle("변수들의 상관관계") + theme_minimal()

data %>% ggplot() + geom_smooth(aes(x = G1E_HGHT, y = G1E_WGHT), col = '#8A8585') + xlab("신장") + ylab("체중")
```